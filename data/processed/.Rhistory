library(tidyverse)
library(questionr)
library(ggplot2)
library(readr)
library(scales)
setwd("C:/Users/abdel/Desktop/Cours Master/Git_dossier/traitement-donnee-systeme-soin/data/processed")
Autriche <- read_csv("AT_people.csv")
Danemark <- read_csv("DK_people.csv")
Autriche <- rename(Autriche,
ID = RB030,
Poids = RB050,
SEXE = RB090,
ANAI = RB080,
ANN_REC = PB010,
STATUT_MAR = PB190,
SANTE_PERC = PH010,
MALADIE_CHRO =PH020,
HANDI = PH030,
UNMET_MED = PH040,
UNMET_MED_REAS = PH050,
UNMET_DENT = PH060,
UNMET_DENT_REAS = PH070,
ANREC = ANREC,
DIPL = PE040)
Danemark <- rename(Danemark,
ID = RB030,
Poids = RB050,
SEXE = RB090,
ANAI = RB080,
ANN_REC = PB010,
STATUT_MAR = PB190,
SANTE_PERC = PH010,
MALADIE_CHRO =PH020,
HANDI = PH030,
UNMET_MED = PH040,
UNMET_MED_REAS = PH050,
UNMET_DENT = PH060,
UNMET_DENT_REAS = PH070,
ANREC = ANREC,
DIPL = PE040)
Autriche$SANTE_PERC[Autriche$SANTE_PERC %in% c("1","2")] <- "Bonne ou très bonne"
Autriche$SANTE_PERC[Autriche$SANTE_PERC %in% c("4","5")] <- "Mauvaise ou très mauvaise"
Autriche$SANTE_PERC[Autriche$SANTE_PERC %in% "3"] <- "Ni bonne ni mauvaise"
Danemark$SANTE_PERC[Danemark$SANTE_PERC %in% c("1","2")] <- "Bonne ou très bonne"
Danemark$SANTE_PERC[Danemark$SANTE_PERC %in% c("4","5")] <- "Mauvaise ou très mauvaise"
Danemark$SANTE_PERC[Danemark$SANTE_PERC %in% "3"] <- "Ni bonne ni mauvaise"
Sante_Dk <- Sante_Dk %>% group_by(Sante_perc) %>% mutate(Variation = ifelse(Annee == 2006, 100 ,(100 +((Effectifs_pond-Effectifs_pond[1]))/(Effectifs_pond[1])*100)))
Sante_Dk <- rename(Sante_Dk, "Sante_perc"="Var1","Annee"="Var2","Effectifs_pond"="Freq")
Sante_Dk <- as.data.frame(wtd.table(Danemark$SANTE_PERC , Danemark$ANREC,w=Danemark$Poids))
View(Sante_Dk)
Sante_At <- as.data.frame(wtd.table(Autriche$SANTE_PERC , Autriche$ANREC,w=Autriche$Poids))
View(Sante_At)
#On renomme les variables
Sante_Dk <- rename(Sante_Dk, "Sante_perc"="Var1","Annee"="Var2","Effectifs_pond"="Freq")
Sante_At <- rename(Sante_At, "Sante_perc"="Var1","Annee"="Var2","Effectifs_pond"="Freq")
### On créer une variable "Variation" pour faire le graphique comparatif (2006 = Base 100)
Sante_Dk <- Sante_Dk %>% group_by(Sante_perc) %>% mutate(Variation = ifelse(Annee == 2006, 100 ,(100 +((Effectifs_pond-Effectifs_pond[1]))/(Effectifs_pond[1])*100)))
Sante_At <- Sante_At %>% group_by(Sante_perc) %>% mutate(Variation = ifelse(Annee == 2006, 100 ,(100+((Effectifs_pond-Effectifs_pond[1]))/(Effectifs_pond[1])*100)))
### On trace les graphiques de variation de l'état de perçu
ggplot(Sante_Dk, aes(x = Annee, y = Variation, color = Sante_perc, group = Sante_perc )) +
geom_point() +
geom_line()+
xlab("Annee") +
ylab("Variation") +
theme_light() #+
#theme(legend.position= "none")
ggplot(Sante_At, aes(x = Annee, y = Variation, color = Sante_perc, group = Sante_perc )) +
geom_point() +
geom_line()+
xlab("Annee") +
ylab("Variation") +
theme_light() #+
Sante_Dk <- Sante_Dk %>% group_by(Annee) %>% mutate(Pourcentage = Effectifs_pond/sum(Effectifs_pond))
Sante_At <- Sante_At %>% group_by(Annee) %>% mutate(Pourcentage = Effectifs_pond/sum(Effectifs_pond))
## Danemark en effectifs pondérés
ggplot(Sante_Dk, aes(x = Annee, y = Effectifs_pond, color = Sante_perc, group = Sante_perc )) +
geom_point() +
geom_line()+
xlab("Annee") +
ylab("Effectifs") +
theme_light() #+
#theme(legend.position= "none")
## Autriche en effectifs pondérés
ggplot(Sante_At, aes(x = Annee, y = Effectifs_pond, color = Sante_perc, group = Sante_perc )) +
geom_point() +
geom_line()+
xlab("Annee") +
ylab("Effectifs") +
theme_light() #+
ggplot() +
geom_point(data= Sante_At,aes(x = Annee, y = Pourcentage, color = Sante_perc, group = Sante_perc )) +
geom_point(data= Sante_Dk,aes(x = Annee, y = Pourcentage, color = Sante_perc, group = Sante_perc )) +
geom_point() +
geom_line(data= Sante_At,aes(x = Annee, y = Pourcentage, color = Sante_perc, group = Sante_perc,linetype ="dotdash"), size = 1.5) +
geom_line(data= Sante_Dk,aes(x = Annee, y = Pourcentage, color = Sante_perc, group = Sante_perc,linetype ="dotted"), size = 1.5) +
scale_y_continuous(labels = percent) +
xlab("Annee") +
ylab("Effectifs") +
theme_light() #+
Model_Aut <- glm(relevel(as.factor(UNMET_MED),ref=2)~(relevel(as.factor(SEXE),ref=1))+as.factor(ANN_REC),
family = binomial(logit),
data = Autriche)
odds.ratio(Model_Aut)
Model_Dk <- glm(relevel(as.factor(UNMET_MED),ref=2)~(relevel(as.factor(SEXE),ref=1))+ as.factor(ANN_REC),
family = binomial(logit),
data = Danemark)
odds.ratio(Model_Dk)
Dan <- table(Danemark$DIPL,Danemark$UNMET_MED)
View(Dan)
Dan <- table(Danemark$UNMET_MED,Danemark$SEXE,Danemark$UNMET_DENT)
View(Dan)
Dan <- table(Danemark$UNMET_MED,Danemark$SEXE,Danemark$DIPL)
Autriche$DIPL[Autriche$DIPL %in% c("0","1","2")] <- "Collège ou avant"
Autriche$DIPL[Autriche$DIPL %in% c("3","4")] <- "Lycée"
Autriche$DIPL[Autriche$DIPL %in% c("5","6")] <- "Diplôme du supérieur"
Danemark$DIPL[Danemark$DIPL %in% c("0","1","2")] <- "Collège ou avant"
Danemark$DIPL[Danemark$DIPL %in% c("3","4")] <- "Lycée"
Danemark$DIPL[Danemark$DIPL %in% c("5","6")] <- "Diplôme du supérieur"
Dan <- table(Danemark$UNMET_MED,Danemark$SEXE,Danemark$DIPL)
Dan <- as.data.frame(wtd.table(Danemark$SANTE_PERC,Danemark$UNMET_MED,Danemark$SEXE,Danemark$DIPL, w=Danemark$Poids))
wtd.table(Danemark$SANTE_PERC, Danemark$UNMET_MED, Danemark$SEXE, Danemark$DIPL, w=Danemark$Poids)
Dan <- as.data.frame(wtd.table(Danemark$SANTE_PERC, Danemark$UNMET_MED, Danemark$DIPL, w=Danemark$Poids))
View(Dan)
Dan <- rename(Sante_Dk, "Sante_perc"="Var1","UNMET_MED"="Var2","Effectifs_pond"="Freq")
Dan <- rename(Dan, "Sante_perc"="Var1","UNMET_MED"="Var2","Effectifs_pond"="Freq")
ggplot(data=Dan) +
geom_bar()
ggplot(data=Dan) +
geom_bar(aes(x=UNMET_MED, y="Effectifs_pond"))
ggplot(data=Dan) +
geom_bar(aes(x=UNMET_MED, y="Effectifs_pond"))
ggplot(data=Dan) +
geom_boxplot(aes(x=UNMET_MED, y="Effectifs_pond"))
Dan <- as.data.frame(wtd.table(Danemark$SANTE_PERC, Danemark$UNMET_MED, Danemark$DIPL, Danemark$SEXE, w=Danemark$Poids))
chisq.test(Dan)
chisq.test(Dan$UNMET_MED)
## Le faire en descriptif ( chi 2)
chisq.test(Model_Aut)
chisq.test(Sante_Dk)
View(Dan)
Tab<-as.data.frame(wtd.table(Autriche$SEXE, Autriche$UNMET_MED,w=Autriche$Poids))
chisq.test(Tab)
View(Tab)
Tab<-as.data.frame(wtd.table(Autriche$UNMET_MED,w=Autriche$Poids))
View(Tab)
chisq.test(Tab)
pchisq(Model_Aut)
pchisq(Model_Aut,df=1)
chisq.test(Autriche)
drop1(Model_Aut, test="Chisq")
drop1(Model_Dan, test="Chisq")
drop1(Model_Dk, test="Chisq")
drop1(Model_Aut_2, test= "Chisq")
Model_Aut_2 <- glm(relevel(as.factor(UNMET_MED),ref=2)~as.factor(ANN_REC)+DIPL,
family = binomial(logit),
data = Autriche)
odds.ratio(Model_Aut_2)
## On fait pareil pour le Danemark
Model_Dk_2 <- glm(relevel(as.factor(UNMET_MED),ref=2)~as.factor(ANN_REC)+DIPL,
family = binomial(logit),
data = Danemark)
odds.ratio(Model_Dk_2)
## On fait pareil pour le Danemark
Model_Dk_2 <- glm(relevel(as.factor(UNMET_MED),ref=2)~as.factor(ANN_REC)+relevel((DIPL),ref="Collège ou avant"),
family = binomial(logit),
data = Danemark)
View(Danemark)
